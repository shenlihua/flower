<include file="Common/_meta"/>

<body>
<article class="page-container">
	<form class="form form-horizontal" id="form">
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品名称：</label>
			<div class="formControls col-xs-4 col-sm-4">
				<input type="text" class="input-text"  placeholder="商品名称"  name="name" value="{$info['name']}">
			</div>
			<div class="formControls col-xs-4 col-sm-6"></div>
		</div>

        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品分类：</label>
            <div class="formControls col-xs-4 col-sm-4">
                <div class="col-xs-6 col-sm-6" style="padding-left: 0px;padding-right: 0px;">
                <select name="cate_one" class="select-box">
                    <option value="">请选择</option>
                    <volist name="cates" id="ct">
                        <option value="{$key}" {: $cate_one==$key?'selected':''}>{$ct}</option>
                    </volist>
                </select>
                </div>
                <div class=" col-xs-6 col-sm-6">
                    <select name="cate_two" class="select-box">
                        <option value="">请选择</option>
                        <volist name="cate_two" id="two">
                            <option value="{$key}" {: $info['cate_id']==$key?'selected':''}>{$two}</option>
                        </volist>
                    </select>
                </div>
            </div>
            <div class="formControls col-xs-4 col-sm-6"></div>
        </div>
        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品价格：</label>
            <div class="formControls col-xs-4 col-sm-4">
                <input type="text" class="input-text"  placeholder="商品价格"  name="price" value="{$info['price']}">
            </div>
            <div class="formControls col-xs-4 col-sm-6"></div>
        </div>


        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品参数：</label>
            <div class="formControls col-xs-4 col-sm-4">
                <a class="btn btn-primary radius mb-5" id="add_param"><i class="iconfont">&#xf0020;</i> 新增参数</a>
                <if condition="$info">
                    <volist name="info['params']" id="ps">
                        <input type="text" class="input-text"  placeholder="商品参数"  name="params[]" value="{$ps}">
                    </volist>
                <else/>
                    <input type="text" class="input-text"  placeholder="商品参数"  name="params[]" value="">
                </if>

            </div>
            <div class="formControls col-xs-4 col-sm-6"></div>
        </div>

        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品简介：</label>
            <div class="formControls col-xs-4 col-sm-4">
                <textarea class="textarea" name="introduction">{$info['introduction']}</textarea>
            </div>
            <div class="formControls col-xs-4 col-sm-6"></div>
        </div>


        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品图片：</label>
            <div class="formControls col-xs-5 col-sm-5">
                <!--dom结构部分-->
                <div id="uploader" class="wu-example">
                    <div class="queueList">
                        <div id="dndArea" class="placeholder">
                            <div id="filePicker" style="float:none;"></div>
                            <p>或将照片拖到这里，单次最多可选5张</p>
                        </div>
                    </div>
                    <div class="statusBar" style="display:none;">
                        <div class="progress">
                            <span class="text">0%</span>
                            <span class="percentage"></span>
                        </div><div class="info"></div>
                        <div class="btns">
                            <div id="filePicker2"></div><div class="uploadBtn">开始上传</div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="formControls col-xs-3 col-sm-2">
                <ul>
                    <volist name="info['img']" id="img">
                    <li style="padding-bottom: 5px;">
                        <img src="http://{: C('UPLOAD_TYPE_CONFIG.domain').$img}?imageView2/0/w/80/h/30"/>
                        <input type="hidden" name="img[]" value="{$img}"/>
                    </li>
                    </volist>
                </ul>
            </div>
        </div>


        <div class="row cl">
            <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商品说明：</label>
            <div class="formControls col-xs-7 col-sm-7">
                <!-- 加载编辑器的容器 -->
                <script id="container" name="information" type="text/plain">{$info['information']|htmlspecialchars_decode}</script>
            </div>
            <div class="formControls col-xs-1 col-sm-3"></div>
        </div>


		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
                <input type="hidden" name="id" value="{$info['id']}">
				<button  class="btn btn-primary radius" type="button" id="submit"><i class="Hui-iconfont">&#xe632;</i> 保存</button>
			</div>
		</div>
	</form>
</article>


</body>
</html>
<!-- 配置文件 -->
<script type="text/javascript" src="__PUBLIC__/Admin/lib/ueditor/1.4.3/ueditor.config.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/lib/ueditor/1.4.3/ueditor.all.js"></script>
<!--上传图片-->
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/lib/webuploader/0.1.5/webuploader.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/lib/webuploader/0.1.5/demo.css">
<script type="text/javascript" src="__PUBLIC__/Admin/lib/webuploader/0.1.5/webuploader.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/lib/webuploader/0.1.5/demo.js"></script>
<script>
    // 添加全局站点信息
    var upload_server="{: U('Common/uploadImg')}";
    //控制上传文件数量
    var fileNumLimit="{: 5-($info?count($info['img']):0)}";
    $(function () {
        var ue = UE.getEditor('container', {
            serverUrl:"{: U('Ueditor/manager')}",
            toolbars: [
                ['fullscreen', 'source', 'undo', 'redo','bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist','simpleupload']
            ],
            initialFrameWidth:750,
            initialFrameHeight:390,

        });



        $("select[name='cate_one']").change(function () {
            $.get("{: U('getDownCate')}", {id: $(this).val()}, function (result) {
                $("select[name='cate_two']").html(result);
            });
        });

        $("#add_param").click(function(){
            $(this).parent().append(($(this).next().clone()));
        });

        $("#submit").click(function(){
            $.post("{: U('addAction')}", $("#form").serialize(), function(result){
                layer.msg(result['msg']);
               /* if(!result['code']){
                    setTimeout(function(){window.history.back()},1500);
                }*/
            });
        });

    });
</script>